-# ãƒ‘ãƒ³ããš
-# - breadcrumb :show
= render "header"
.card
  .card-menu
    - if user_signed_in? && current_user.id == @item.user_id
      .card-edit
        = link_to "ç·¨é›†ã™ã‚‹", edit_item_path
      .card-delete
        = link_to "å‰Šé™¤ã™ã‚‹", item_path(@item), method: :delete, class: "item_delete", data: { confirm: "æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ" }
      .card-serve
        = link_to "å‡ºå“ä¸€æ™‚åœæ­¢", reserve_item_path(@item.id), class:"product-details-resorve__btn"
    - elsif @item.buy_ids.present?
      .card-warning
        = link_to "å£²ã‚Šåˆ‡ã‚Œã¾ã—ãŸ"
    - elsif user_signed_in? && current_user.email == @item.reservation_email.present? && @item.reservation_email
      .card-cash
        = link_to "è³¼å…¥ã™ã‚‹", buys_path
    - elsif user_signed_in? && current_user.email != @item.reservation_email.present? && @item.reservation_email
      .card-warning
        = link_to "å‡ºå“ä¸€æ™‚åœæ­¢ä¸­", root_path,class:"disabled-button bold"
    - else
      .card-cash
        = link_to "è³¼å…¥ã™ã‚‹",buy_path,class:"product-purchase__btn"
  .card-title
    %h1.text-title
      %span.card-text
      = @item.title
    %p.text-top
      %span.card-text
    .slick_container
      .slick_inner
        .slider-5-thum
          - @item.images.each do |image|
            .slick_image
              = image_tag image.image.url, class: "item_image" if image.image.present?
        - if @item.images.length > 2
          .slider-5-nav
            - @item.images.each do |image|
              .slick_image
                = image_tag image.image.url, class: "item_image", width: "300px", height: "200px" if image.image.present?
    %h4.text-center
      %span.card-proce
      = "Â¥#{@item.price}"
    %p.text-bottom
      %span.card-text
      = @item.text
  -# .card-cash
  -#   - unless user_signed_in? && current_user.id == @item.user_id
  -#     - if user_signed_in? && current_user.id
  -#       - if @item.reservation_email.present? && @item.reservation_email != current_user.email
  -#         %h1.cash-cash= link_to "è³¼å…¥æ‰‹ç¶šãã¸", buy_path(@item)
  .card-table
    %table{:border => 1, :width => "50%"}
      %tr
        %th ç™»éŒ²æ—¥æ™‚
        %td= @item.created_at.strftime("%Yå¹´%-mæœˆ%-dæ—¥")
      %tr
        %th å‡ºå“è€…
        %td= link_to @item.user.name, user_path(@item.user.id)
      %tr
        %th ã‚«ãƒ†ã‚´ãƒªãƒ¼
        %td
          = @item.category.parent.parent.name
          %span >
          = @item.category.parent.name
          %span >
          = @item.category.name

      %tr
        %th ãƒ–ãƒ©ãƒ³ãƒ‰
        %td= @item.brand
      %tr
        %th å•†å“ã®çŠ¶æ…‹
        %td= @item.condition
      %tr
        %th åœ¨åº«
        %td= @item.stock
      %tr
        %th é…é€æ–™ã®è² æ‹…
        %td é€æ–™è¾¼ã¿(å‡ºå“è€…è² æ‹…)
      %tr
        %th é…é€å…ƒã®åœ°åŸŸ
        %td=@item.user.address.area
      %tr
        %th é…é€æ–¹æ³•
        %td= @item.delivery.name
      %tr
        %th é…é€ç›®å®‰
        %td=  "#{@item.leadtime}æ—¥ã§ç™ºé€"
  .btn-bar
    .btn-box
      = render partial: "items/like", locals: { item: @item, like: @like }
- if user_signed_in?
  .Chat
    .MessageField
      - @item.comments.each do |comment|
        .MessageInfo__userimage
        - if comment.user.profile.image.present?
          = image_tag comment.user.profile.image.url, class: "self_image" if comment.user.profile.image.present?
        - else
          = image_tag  "default.png", class: "self_image"
        .MessageBox
          .Message
            %h1= comment.text
          .MessageInfo
            .MessageInfo__userName
              %p= comment.user.name
            .MessageInfo__userTrash
              - if user_signed_in? && current_user.id == comment.user_id
                %p= link_to icon("fas","trash"), item_comment_path(@item, comment), method: :delete, data: { confirm: "æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ"}
    .warning
      %p.text-waring
        %span.card-warning ç›¸æ‰‹ã®äº‹ã‚’è€ƒãˆä¸å¯§ãªã‚³ãƒ¡ãƒ³ãƒˆã‚’å¿ƒãŒã‘ã¾ã—ã‚‡ã†ã€‚
        %br
        %span.card-warning ä¸å¿«ãªè¨€è‘‰é£ã„ã¯åˆ©ç”¨åˆ¶é™ã‚„é€€ä¼šå‡¦åˆ†ã«ãªã‚‹äº‹ãŒã‚ã‚Šã¾ã™ã€‚
    .form
      = form_with model: [@item, @comment], local: true, id: "new_comment" do |f|
        -# = f.hidden_field :user_id, { value: current_user.id}
        = f.text_area :text, class: "form-area"
        = f.submit "ğŸ’¬ã‚³ãƒ¡ãƒ³ãƒˆã™ã‚‹", class: "submit"
